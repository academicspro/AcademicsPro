generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model School {
  id        String   @id @default(cuid())
  name      String
  phone     String   @unique
  address   String
  city      String
  state     String
  country   String
  pincode   String
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt 
  users     User[] @relation()
}


// User Models are defined here
model User {
  id        String   @id @default(cuid())
  email     String   @unique
  password  String 
  role      Role     @default(superadmin)
  schoolId  String?
  school    School?   @relation(fields: [schoolId], references: [id])
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt  

  PasswordResetToken PasswordResetToken[]
}

enum Role {
  superadmin
  admin
  student
  teacher
  parent
  account
  hostel
  library
}

model PasswordResetToken {
  id        Int      @id @default(autoincrement())
  token     String   @unique
  userId    String   
  createdAt DateTime @default(now())
  expiresAt DateTime
  usedAt    DateTime? 

  user      User     @relation(fields: [userId], references: [id])

  @@index([expiresAt]) 
}